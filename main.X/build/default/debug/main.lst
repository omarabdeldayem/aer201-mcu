MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;******************************************************************************;
                      00002 ;        ____    ___  ______    ___  ____       ____  ____  ____    ___  ____  ;
                      00003 ;       |    \  /  _]|      T  /  _]|    \     |    \l    j|    \  /  _]|    \ ;
                      00004 ;       |  o  )/  [_ |      | /  [_ |  D  )    |  o  )|  T |  o  )/  [_ |  D  );
                      00005 ;       |   _/Y    _]l_j  l_jY    _]|    /     |   _/ |  | |   _/Y    _]|    / ;
                      00006 ;       |  |  |   [_   |  |  |   [_ |    \     |  |   |  | |  |  |   [_ |    \ ;
                      00007 ;       |  |  |     T  |  |  |     T|  .  Y    |  |   j  l |  |  |     T|  .  Y;
                      00008 ;       l__j  l_____j  l__j  l_____jl__j\_j    l__j  |____jl__j  l_____jl__j\_j;
                      00009 ;------------------------------------------------------------------------------;
                      00010 ;               AER201 Team 61 'Peter Piper' Pipe Inspector                    ;
                      00011 ;                        Author: Omar Abdeldayem                               ;
                      00012 ;                           Created: 1/12/2016                                 ;
                      00013 ;------------------------------------------------------------------------------;
                      00014 ; DESCRIPTION:                                                                                          
                                                               ;
                      00015 ; It does shit, yo.                                                                                     
                                                               ;
                      00016 ;******************************************************************************;
                      00017 ;******************************************************************************;
                      00018 ;******************************************************************************;
                      00019 
                      00020         List    p=16f877                    ; list directive to define processor
                      00021         #include        <p16f877.inc>       ; processor specific variable definitions
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Dec 08 2015
                      00005 ;  MPASM PIC16F877 processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2015 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      00541         LIST
2007   3F72           00022         __CONFIG _CP_OFF & _WDT_OFF & _BODEN_ON & _PWRTE_ON & _HS_OSC & _WRT_ENABLE_ON & _CPD_OFF & _LVP
                            _OFF
                      00023 
                      00024         #include        <rtc_macros.inc>
                      00001         ;External labels
  0000                00002         extern  write_rtc,read_rtc,rtc_convert,i2c_common_setup
                      00003 
                      00004 ;RTC Macros;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00005 
                      00006 rtc_resetAll    macro
                      00007 ;input:         none
                      00008 ;output:        none
                      00009 ;desc:          Resets all the time keeping registers on the RTC to zero
                      00010         banksel     0x74
                      00011         clrf        0x74
                      00012         banksel     0x73
                      00013         clrf        0x73
                      00014         call        write_rtc           ;Write 0 to Seconds
                      00015         banksel     0x73
                      00016         incf        0x73                        ;Set register address to 1
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00017         call        write_rtc
                      00018         banksel     0x73
                      00019         incf        0x73                        ;Set register address to 2
                      00020         call        write_rtc
                      00021         banksel     0x73
                      00022         incf        0x73                        ;Set register address to 3
                      00023         call        write_rtc
                      00024         banksel     0x73
                      00025         incf        0x73                        ;Set register address to 4
                      00026         call        write_rtc
                      00027         banksel     0x73
                      00028         incf        0x73                        ;Set register address to 5
                      00029         call        write_rtc
                      00030         banksel     0x73
                      00031         incf        0x73                        ;Set register address to 6
                      00032         call        write_rtc
                      00033         endm
                      00034 
                      00035 rtc_set macro       addliteral, datliteral
                      00036 ;input:         addliteral: value of address
                      00037 ;                       datliteral: value of data
                      00038 ;output:        none
                      00039 ;desc:          loads the data in datliteral into the 
                      00040 ;                       address specified by addliteral in the RTC
                      00041         banksel     0x73
                      00042         movlw       addliteral
                      00043         movwf       0x73
                      00044         banksel     0x74
                      00045         movlw       datliteral
                      00046         movwf       0x74        
                      00047         call        write_rtc
                      00048         endm
                      00049 
                      00050 rtc_read macro      addliteral
                      00051 ;input:         addliteral
                      00052 ;output:        0x75, 0x77, 0x78
                      00053 ;desc:          From the selected register in the RTC, read the data
                      00054 ;                       and load it into 0x75. 0x75 is also converted into 
                      00055 ;                       ASCII characters and the tens digit is placed into
                      00056 ;                       0x77 and the ones digit is placed in 0x78
                      00057         movlw       addliteral
                      00058         banksel     0x73
                      00059         movwf       0x73
                      00060         call        read_rtc
                      00061         banksel     0x75
                      00062         movf        0x75,w
                      00063         call        rtc_convert   
                      00064         endm
                      00065 
                      00066 
                      00067 
                      00068 
                      00069 
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00070 
                      00025         #include        <lcd.inc>
  0000                00001     extern      InitLCD,WR_INS,WR_DATA,CLR_LCD
                      00002 
                      00003 
                      00026 ;******************************************************************************;
                      00027 ;                               BANK0 RAM                                      ;
                      00028 ;******************************************************************************;
                      00029         CBLOCK      0x30
                      00030                     ; RTC I2C Mem
  00000030            00031         dt1         ; 0x30          
  00000031            00032         dt2
  00000032            00033         dt3
  00000033            00034         XBUF
  00000034            00035         count
  00000035            00036         CONTROL
  00000036            00037         ADD
  00000037            00038         DAT
  00000038            00039         flag
  00000039            00040         DOUT
  0000003A            00041         B1
  0000003B            00042         B2
                      00043                     ; LCD MEM
  0000003C            00044         lcd_tmp
  0000003D            00045         lcd_d1
  0000003E            00046         lcd_d2
  0000003F            00047         long_del
  00000040            00048         temp_w      ; 0x40
  00000041            00049         temp_status ; 0x41
                      00050                     ; DIVISION Registers
  00000042            00051         DIV_HI      ; 0X42
  00000043            00052         DIV_LO      ; 0X43
  00000044            00053         DIVISOR     ; 0X44
  00000045            00054         Q
                      00055                     ; 0x48 
                      00056                     ; ROBOT VARS
  00000046            00057         start_min
  00000047            00058         start_min10
  00000048            00059         start_sec
  00000049            00060         start_sec10
  0000004A            00061         stop_min
  0000004B            00062         stop_min10
  0000004C            00063         stop_sec
  0000004D            00064         stop_sec10
  0000004E            00065         multiplex_count
  0000004F            00066         rob_distance
  00000050            00067         measured_distance
  00000051            00068         rob_return
  00000052            00069         spot_count
  00000053            00070         num_spots
  00000054            00071         spot_base_loc
                      00072         ENDC
                      00073 
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00074 ;******************************************************************************;
                      00075 ;                               BANK0 RAM                                      ;
                      00076 ;******************************************************************************;
                      00077         #define     crit_dist       d'5'
                      00078 ;******************************************************************************;
                      00079 ;                               MACROS                                         ;
                      00080 ;******************************************************************************;
                      00081 MULT    macro       val1, val2, result
                      00082         MOVF        val1, W
                      00083         ADDWF       val1, W
                      00084         MOVWF       result
                      00085         DECFSZ      val2, f
                      00086         GOTO        $-3
                      00087         endm
                      00088         
                      00089 WRT_LCD macro       val
                      00090         MOVLW       val
                      00091         CALL        WR_DATA
                      00092         endm
                      00093 LCD_INS macro       val
                      00094         MOVLW       val
                      00095         CALL        WR_INS
                      00096         endm
                      00097         
                      00098 WRT_MEM_LCD macro   val
                      00099         MOVFW       val
                      00100         CALL        WR_DATA
                      00101         endm
                      00102 
                      00103 LCD_DLY macro                           ;Delay ~160us
                      00104         MOVLW       0xFF
                      00105         MOVWF       lcd_d1
                      00106         DECFSZ      lcd_d1, f
                      00107         GOTO        $-1
                      00108         endm
                      00109 
                      00110 ;******************************************************************************;
                      00111 ;                          VECTOR TABLE                                        ;
                      00112 ;******************************************************************************;
                      00113         ORG         0x0000              ; RESET vector must always be at 0x00
0000   2???           00114         GOTO        INIT                ; Just jump to the main code section.
                      00115         ORG         0x0004
0004   2???           00116         GOTO        INT_HANDLER
                      00117 
                      00118 ;******************************************************************************;
                      00119 ;                         ROBOT INITIALIZATION                                 ;
                      00120 ;******************************************************************************;
0005                  00121 INIT
0005   1683           00122         BSF         STATUS, RP0         ; Select bank 1
0006   018B           00123         CLRF        INTCON              ; Disable interrupts for now
                      00124                                         
0007   3018           00125         MOVLW       b'00011000'         ; PORT A pin mapping
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0008   0085           00126         MOVWF       TRISA
0009   30F3           00127         MOVLW       b'11110011'         ; PORT B pin mapping
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000A   0086           00128         MOVWF       TRISB
000B   3079           00129         MOVLW       b'01111001'         ; PORT C pin mapping
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000C   0087           00130         MOVWF       TRISC
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000D   0188           00131         CLRF        TRISD               ; PORT D pin mapping
000E   3007           00132         MOVLW       b'00000111'         ; PORT E pin mapping
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
000F   0089           00133         MOVWF       TRISE
                      00134                      
0010   3080           00135         MOVLW       b'10000000'         ; PWM pulsing period (484Hz)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0011   0092           00136         MOVWF       PR2
                      00137        
0012   1283           00138         BCF         STATUS, RP0         ; select bank 0
                      00139         
                      00140 ;       BSF         INTCON, RBIE        ; Enable interrupts
                      00141 ;       BSF         INTCON, INTE
                      00142 ;       BSF         INTCON, GIE
                      00143         
0013   0195           00144         CLRF        CCPR1L              ; Setup PWM pins
0014   019B           00145         CLRF        CCPR2L
0015   300C           00146         MOVLW       B'00001100'
0016   0097           00147         MOVWF       CCP1CON
0017   009D           00148         MOVWF       CCP2CON
                      00149         
0018   3002           00150         MOVLW       B'00000010'         ; Initialize and start timer 2
0019   0092           00151         MOVWF       T2CON
001A   0191           00152         CLRF        TMR2
001B   1512           00153         BSF         T2CON, TMR2ON
                      00154         
001C   3010           00155         MOVLW       0X10                ; TMR1 for Ultrasonic Sensors
001D   0090           00156         MOVWF       T1CON
001E   018F           00157         CLRF        TMR1H
001F   018E           00158         CLRF        TMR1L
                      00159         
0020   0185           00160         clrf        PORTA
0021   0186           00161         clrf        PORTB
0022   0187           00162         clrf        PORTC 
0023   0188           00163         clrf        PORTD
                      00164          
0024   2???           00165         CALL        i2c_common_setup
                      00166                     rtc_resetAll
                          M ;input:         none
                          M ;output:        none
                          M ;desc:          Resets all the time keeping registers on the RTC to zero
0025   1283 1303          M         banksel     0x74
0027   01F4               M         clrf        0x74
0028   1283 1303          M         banksel     0x73
002A   01F3               M         clrf        0x73
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

002B   2???               M         call        write_rtc           ;Write 0 to Seconds
002C   1283 1303          M         banksel     0x73
Message[305]: Using default destination of 1 (file).
002E   0AF3               M         incf        0x73                        ;Set register address to 1
002F   2???               M         call        write_rtc
0030   1283 1303          M         banksel     0x73
Message[305]: Using default destination of 1 (file).
0032   0AF3               M         incf        0x73                        ;Set register address to 2
0033   2???               M         call        write_rtc
0034   1283 1303          M         banksel     0x73
Message[305]: Using default destination of 1 (file).
0036   0AF3               M         incf        0x73                        ;Set register address to 3
0037   2???               M         call        write_rtc
0038   1283 1303          M         banksel     0x73
Message[305]: Using default destination of 1 (file).
003A   0AF3               M         incf        0x73                        ;Set register address to 4
003B   2???               M         call        write_rtc
003C   1283 1303          M         banksel     0x73
Message[305]: Using default destination of 1 (file).
003E   0AF3               M         incf        0x73                        ;Set register address to 5
003F   2???               M         call        write_rtc
0040   1283 1303          M         banksel     0x73
Message[305]: Using default destination of 1 (file).
0042   0AF3               M         incf        0x73                        ;Set register address to 6
0043   2???               M         call        write_rtc
0044   2???           00167         CALL        SET_RTC_TIME
0045   2???           00168         CALL        InitLCD
                      00169         
0046   3000           00170         MOVLW       b'0'                ; Initialize variables
0047   00D3           00171         MOVWF       num_spots
0048   00D2           00172         MOVWF       spot_count
                      00173                                         
                      00174                                         
0049   2???           00175         CALL        START_MSG
                      00176 
                      00177 ;******************************************************************************;
                      00178 ;                        ROBOT START AND STANDBY                               ;
                      00179 ;******************************************************************************;
004A                  00180 START_STDBY
004A   1C86           00181         BTFSS       PORTB, 1            ; Wait until data is available from the keypad
004B   2???           00182         GOTO        START_STDBY
                      00183 
004C   0E06           00184         SWAPF       PORTB, W            ; Read PortB<7:4> into W<3:0>
004D   390F           00185         ANDLW       0x0F
004E   2???           00186         CALL        CLR_LCD
                      00187 
004F   1886           00188         BTFSC       PORTB,1             ; Wait until key is released
0050   2???           00189         GOTO        $-1
                      00190         
0051   2???           00191         CALL        CLR_LCD
0052   2???           00192         CALL        GET_START_TIME
0053   2???           00193         GOTO        SCAN
                      00194 
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00195 ;******************************************************************************;
                      00196 ;                           SENSOR CALIBRATION                                 ;
                      00197 ;******************************************************************************;
0054                  00198 CALIBRATE
0054   2???           00199         GOTO        CALIBRATE
                      00200         
                      00201 ;******************************************************************************;
                      00202 ;                         PIPE SCAN SUPERLOOP                                  ;
                      00203 ;******************************************************************************;
0055                  00204 SCAN
0055   2???           00205         CALL        PWML
0056   2???           00206         CALL        PWMR
0057   2???           00207         CALL        USONIC_SEND_PULSE
0058   2???           00208         CALL        USONIC_READ_ECHO
                      00209 ;       CALL        SHOW_RTC                ; DEBUG
0059   2???           00210         CALL        READ_IRS
005A   2???           00211         GOTO        SCAN
                      00212         
                      00213 ;******************************************************************************;
                      00214 ;                          INTERRUPT HANDLER                                   ;
                      00215 ;******************************************************************************;
005B                  00216 INT_HANDLER
005B   00C0           00217         MOVWF       temp_w
005C   0E03           00218         SWAPF       STATUS, W
005D   00C1           00219         MOVWF       temp_status
005E   100B           00220         BCF         INTCON, RBIF
005F   108B           00221         BCF         INTCON, INTF          ; Clear the interrupt flag
0060   0E41           00222         SWAPF       temp_status, W
0061   0083           00223         MOVWF       STATUS
0062   0EC0           00224         SWAPF       temp_w, F
0063   0E40           00225         SWAPF       temp_w, W
0064   2???           00226         GOTO        STOP_STDBY
0065   0009           00227         RETFIE
                      00228         
                      00229 ;******************************************************************************;
                      00230 ;                           PWM CONTROL                                        ;
                      00231 ;******************************************************************************;
0066                  00232 PWML    
Message[305]: Using default destination of 1 (file).
0066   0F95           00233         INCFSZ      CCPR1L
0067   2???           00234         GOTO        PWML
0068                  00235 PWML_DN 
Message[305]: Using default destination of 1 (file).
0068   0B95           00236         DECFSZ      CCPR1L
0069   2???           00237         GOTO        PWML_DN
006A   0008           00238         RETURN
                      00239 
006B                  00240 PWMR    
Message[305]: Using default destination of 1 (file).
006B   0F9B           00241         INCFSZ      CCPR2L
006C   2???           00242         GOTO        PWMR
006D                  00243 PWMR_DN 
Message[305]: Using default destination of 1 (file).
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

006D   0B9B           00244         DECFSZ      CCPR2L
006E   2???           00245         GOTO        PWMR_DN
006F   0008           00246         RETURN
                      00247 
                      00248 ;******************************************************************************;
                      00249 ;                       CYCLE INFRARED SENSORS                                 ;
                      00250 ;******************************************************************************;
0070                  00251 READ_IRS
0070   3007           00252         MOVLW       d'7'
0071   00CE           00253         MOVWF       multiplex_count
0072                  00254 MX_LOOP 
0072   2???           00255         CALL        LONG_DLY
                      00256         ;BCF        PORTE, 0
                      00257         ;BTFSC      multiplex_count, 0
                      00258         ;BSF        PORTE, 0
0073   1005           00259         BCF         PORTA, 0
0074   184E           00260         BTFSC       multiplex_count, 0
0075   1405           00261         BSF         PORTA, 0
0076   1085           00262         BCF         PORTA, 1
0077   18CE           00263         BTFSC       multiplex_count, 1
0078   1485           00264         BSF         PORTA, 1
0079   1105           00265         BCF         PORTA, 2
007A   194E           00266         BTFSC       multiplex_count, 2
007B   1505           00267         BSF         PORTA, 2
                      00268         ;BTFSS      PORTC, 0
                      00269         ;GOTO       $+2
                      00270         ;INCF       num_spots, f
Message[305]: Using default destination of 1 (file).
007C   0BCE           00271         DECFSZ      multiplex_count
007D   2???           00272         GOTO        MX_LOOP
007E   0008           00273         RETURN
                      00274         
                      00275 ;******************************************************************************;
                      00276 ;                       TOGGLE ARM STATE ROUTINE                               ;
                      00277 ;******************************************************************************;
007F                  00278 ARM_TOGGLE
                      00279         ; control servo to control arm
                      00280         ; if degree is set to 180, set to 0
                      00281         ; otherwise set to 0
007F   2???           00282         GOTO        ARM_TOGGLE
                      00283 
                      00284 ;******************************************************************************;
                      00285 ;                         ROBOT REALIGNMENT ROUTINE                            ;
                      00286 ;******************************************************************************;
0080                  00287 REALIGN
0080   0008           00288         RETURN
                      00289         
                      00290 ;******************************************************************************;
                      00291 ;                     ULTRASONIC SENSOR SUBROUTINES                            ;
                      00292 ;******************************************************************************;
0081                  00293 USONIC_SEND_PULSE
0081   1586           00294         BSF         PORTB, 3
                      00295         LCD_DLY
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0082   30FF               M         MOVLW       0xFF
0083   00BD               M         MOVWF       lcd_d1
0084   0BBD               M         DECFSZ      lcd_d1, f
0085   2???               M         GOTO        $-1
0086   1186           00296         BCF         PORTB, 3
                      00297         LCD_DLY
0087   30FF               M         MOVLW       0xFF
0088   00BD               M         MOVWF       lcd_d1
0089   0BBD               M         DECFSZ      lcd_d1, f
008A   2???               M         GOTO        $-1
008B   0008           00298         RETURN
                      00299 
008C                  00300 USONIC_READ_ECHO
008C   1E06           00301         BTFSS       PORTB, 4
008D   2???           00302         GOTO        $-1
008E   1410           00303         BSF         T1CON, 0
008F   1A06           00304 USHOLD  BTFSC       PORTB, 4
0090   2???           00305         GOTO        USHOLD
0091   1010           00306         BCF         T1CON, 0
0092   080F           00307         MOVF        TMR1H, W
0093   00C2           00308         MOVWF       DIV_HI
0094   080E           00309         MOVF        TMR1L, W
0095   00C3           00310         MOVWF       DIV_LO
0096   018F           00311         CLRF        TMR1H
0097   018E           00312         CLRF        TMR1L
0098   303C           00313         MOVLW       d'60'
0099   00C4           00314         MOVWF       DIVISOR
009A   2???           00315         CALL        DIV16X8
009B   0845           00316         MOVF        Q, W
009C   00D0           00317         MOVWF       measured_distance
009D   0845           00318         MOVF        Q, W
009E   2???           00319         CALL        CLR_LCD
009F   2???           00320         CALL        rtc_convert
                      00321         WRT_MEM_LCD 0x77
00A0   0877               M         MOVFW       0x77
00A1   2???               M         CALL        WR_DATA
                      00322         WRT_MEM_LCD 0x78
00A2   0878               M         MOVFW       0x78
00A3   2???               M         CALL        WR_DATA
00A4   0008           00323         RETURN
                      00324 
                      00325 ;******************************************************************************;
                      00326 ;                           RETURN HOME ROUTINE                                ;
                      00327 ;******************************************************************************;
00A5                  00328 RETURN_HOME
                      00329         
00A5   0008           00330         RETURN
                      00331 
                      00332 
                      00333 ;******************************************************************************;
                      00334 ;                             STOP STANDBY                                     ;
                      00335 ;******************************************************************************;
00A6                  00336 STOP_STDBY
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00A6   2???           00337         CALL        GET_STOP_TIME
                      00338 ;       CALL        STOP_STDBY_MSG
00A7   1C86           00339         BTFSS       PORTB, 1            ; Wait until data is available from the keypad
00A8   2???           00340         GOTO        STOP_STDBY
                      00341 
00A9   0E06           00342         SWAPF       PORTB, W            ; Read PortB<7:4> into W<3:0>
00AA   390F           00343         ANDLW       0x0F 
00AB   2???           00344         CALL        CLR_LCD
00AC   2???           00345         GOTO        STOP_DATA
                      00346 
                      00347 ;******************************************************************************;
                      00348 ;                               DISPLAY DATA                                   ;
                      00349 ;******************************************************************************;
00AD                  00350 STOP_DATA       
00AD   2???           00351         CALL        WRT_DATA
00AE   2???           00352         CALL        LONG_DLY
00AF   2???           00353         CALL        LONG_DLY
00B0   2???           00354         CALL        LONG_DLY
00B1   2???           00355         CALL        LONG_DLY
00B2   2???           00356         CALL        LONG_DLY
00B3   2???           00357         CALL        LONG_DLY
00B4   2???           00358         CALL        LONG_DLY
                      00359         
00B5   2???           00360         CALL        CLR_LCD
                      00361         
00B6   3054           00362         MOVLW       spot_base_loc
00B7   0084           00363         MOVWF       FSR
                      00364         
                      00365         
00B8                  00366 DATA_LOOP       
                      00367         WRT_LCD     "S"
00B8   3053               M         MOVLW       "S"
00B9   2???               M         CALL        WR_DATA
                      00368         WRT_LCD     "P"
00BA   3050               M         MOVLW       "P"
00BB   2???               M         CALL        WR_DATA
                      00369         WRT_LCD     "O"
00BC   304F               M         MOVLW       "O"
00BD   2???               M         CALL        WR_DATA
                      00370         WRT_LCD     "T"
00BE   3054               M         MOVLW       "T"
00BF   2???               M         CALL        WR_DATA
                      00371         WRT_LCD     ":"
00C0   303A               M         MOVLW       ":"
00C1   2???               M         CALL        WR_DATA
                      00372         WRT_LCD     " "
00C2   3020               M         MOVLW       " "
00C3   2???               M         CALL        WR_DATA
                      00373 ;       WRT_MEM_LCD INDF
                      00374         WRT_LCD     "c"
00C4   3063               M         MOVLW       "c"
00C5   2???               M         CALL        WR_DATA
                      00375         WRT_LCD     "m"
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00C6   306D               M         MOVLW       "m"
00C7   2???               M         CALL        WR_DATA
                      00376         
00C8   2???           00377         CALL        LONG_DLY
00C9   2???           00378         CALL        LONG_DLY
00CA   2???           00379         CALL        LONG_DLY
00CB   2???           00380         CALL        LONG_DLY
00CC   2???           00381         CALL        LONG_DLY
00CD   2???           00382         CALL        LONG_DLY
00CE   2???           00383         CALL        LONG_DLY
00CF   2???           00384         CALL        LONG_DLY
00D0   2???           00385         CALL        LONG_DLY
00D1   2???           00386         CALL        CLR_LCD
00D2   0A84           00387         INCF        FSR, F
                      00388 
00D3   0BD2           00389         DECFSZ      spot_count, F
00D4   2???           00390         GOTO        DATA_LOOP
                      00391         
                      00392         WRT_LCD     "E"
00D5   3045               M         MOVLW       "E"
00D6   2???               M         CALL        WR_DATA
                      00393         WRT_LCD     "N"
00D7   304E               M         MOVLW       "N"
00D8   2???               M         CALL        WR_DATA
                      00394         WRT_LCD     "D"
00D9   3044               M         MOVLW       "D"
00DA   2???               M         CALL        WR_DATA
                      00395 
00DB   2???           00396         GOTO        FINISH
                      00397 
                      00398 ;******************************************************************************;
                      00399 ;                                  HELLO                                       ;
                      00400 ;******************************************************************************;
00DC                  00401 START_MSG
                      00402         WRT_LCD     "H"
00DC   3048               M         MOVLW       "H"
00DD   2???               M         CALL        WR_DATA
                      00403         WRT_LCD     "I"
00DE   3049               M         MOVLW       "I"
00DF   2???               M         CALL        WR_DATA
                      00404         WRT_LCD     "T"
00E0   3054               M         MOVLW       "T"
00E1   2???               M         CALL        WR_DATA
                      00405         WRT_LCD     " "
00E2   3020               M         MOVLW       " "
00E3   2???               M         CALL        WR_DATA
                      00406         WRT_LCD     "*"
00E4   302A               M         MOVLW       "*"
00E5   2???               M         CALL        WR_DATA
                      00407         WRT_LCD     " "
00E6   3020               M         MOVLW       " "
00E7   2???               M         CALL        WR_DATA
                      00408         WRT_LCD     "T"
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00E8   3054               M         MOVLW       "T"
00E9   2???               M         CALL        WR_DATA
                      00409         WRT_LCD     "O"
00EA   304F               M         MOVLW       "O"
00EB   2???               M         CALL        WR_DATA
                      00410         WRT_LCD     " "
00EC   3020               M         MOVLW       " "
00ED   2???               M         CALL        WR_DATA
                      00411         WRT_LCD     "S"
00EE   3053               M         MOVLW       "S"
00EF   2???               M         CALL        WR_DATA
                      00412         WRT_LCD     "T"
00F0   3054               M         MOVLW       "T"
00F1   2???               M         CALL        WR_DATA
                      00413         WRT_LCD     "A"
00F2   3041               M         MOVLW       "A"
00F3   2???               M         CALL        WR_DATA
                      00414         WRT_LCD     "R"
00F4   3052               M         MOVLW       "R"
00F5   2???               M         CALL        WR_DATA
                      00415         WRT_LCD     "T"
00F6   3054               M         MOVLW       "T"
00F7   2???               M         CALL        WR_DATA
00F8   0008           00416         RETURN
                      00417         
                      00418 ;******************************************************************************;
                      00419 ;                                GOODBYE                                       ;
                      00420 ;******************************************************************************;
00F9                  00421 STOP_STDBY_MSG
                      00422         WRT_LCD     "H"
00F9   3048               M         MOVLW       "H"
00FA   2???               M         CALL        WR_DATA
                      00423         WRT_LCD     "I"
00FB   3049               M         MOVLW       "I"
00FC   2???               M         CALL        WR_DATA
                      00424         WRT_LCD     "T"
00FD   3054               M         MOVLW       "T"
00FE   2???               M         CALL        WR_DATA
                      00425         WRT_LCD     " "
00FF   3020               M         MOVLW       " "
0100   2???               M         CALL        WR_DATA
                      00426         WRT_LCD     "*"
0101   302A               M         MOVLW       "*"
0102   2???               M         CALL        WR_DATA
                      00427         WRT_LCD     " "
0103   3020               M         MOVLW       " "
0104   2???               M         CALL        WR_DATA
                      00428         WRT_LCD     "F"
0105   3046               M         MOVLW       "F"
0106   2???               M         CALL        WR_DATA
                      00429         WRT_LCD     "O"
0107   304F               M         MOVLW       "O"
0108   2???               M         CALL        WR_DATA
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00430         WRT_LCD     "R"
0109   3052               M         MOVLW       "R"
010A   2???               M         CALL        WR_DATA
                      00431         WRT_LCD     " "
010B   3020               M         MOVLW       " "
010C   2???               M         CALL        WR_DATA
                      00432         WRT_LCD     "D"
010D   3044               M         MOVLW       "D"
010E   2???               M         CALL        WR_DATA
                      00433         WRT_LCD     "A"
010F   3041               M         MOVLW       "A"
0110   2???               M         CALL        WR_DATA
                      00434         WRT_LCD     "T"
0111   3054               M         MOVLW       "T"
0112   2???               M         CALL        WR_DATA
                      00435         WRT_LCD     "A"
0113   3041               M         MOVLW       "A"
0114   2???               M         CALL        WR_DATA
0115   0008           00436         RETURN
                      00437          
                      00438 ;******************************************************************************;
                      00439 ;                                 DATA                                         ;
                      00440 ;******************************************************************************;
0116                  00441 WRT_DATA        
                      00442         WRT_LCD     "N"
0116   304E               M         MOVLW       "N"
0117   2???               M         CALL        WR_DATA
                      00443         WRT_LCD     "U"
0118   3055               M         MOVLW       "U"
0119   2???               M         CALL        WR_DATA
                      00444         WRT_LCD     "M"
011A   304D               M         MOVLW       "M"
011B   2???               M         CALL        WR_DATA
                      00445         WRT_LCD     " "
011C   3020               M         MOVLW       " "
011D   2???               M         CALL        WR_DATA
                      00446         WRT_LCD     "S"
011E   3053               M         MOVLW       "S"
011F   2???               M         CALL        WR_DATA
                      00447         WRT_LCD     "P"
0120   3050               M         MOVLW       "P"
0121   2???               M         CALL        WR_DATA
                      00448         WRT_LCD     "O"
0122   304F               M         MOVLW       "O"
0123   2???               M         CALL        WR_DATA
                      00449         WRT_LCD     "T"
0124   3054               M         MOVLW       "T"
0125   2???               M         CALL        WR_DATA
                      00450         WRT_LCD     "S"
0126   3053               M         MOVLW       "S"
0127   2???               M         CALL        WR_DATA
                      00451         WRT_LCD     ":"
0128   303A               M         MOVLW       ":"
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0129   2???               M         CALL        WR_DATA
                      00452         WRT_LCD     " "
012A   3020               M         MOVLW       " "
012B   2???               M         CALL        WR_DATA
                      00453 ;       WRT_MEM_LCD num_spots
012C   0008           00454         RETURN
                      00455 ;******************************************************************************;
                      00456 ;                           RETREIVE START TIME                                ;
                      00457 ;******************************************************************************;
012D                  00458 GET_START_TIME
                      00459         ;Get minute             
                      00460         rtc_read    0x01                ;Read Address 0x01 from DS1307---min
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
012D   3001               M         movlw       0x01
012E   1283 1303          M         banksel     0x73
0130   00F3               M         movwf       0x73
0131   2???               M         call        read_rtc
0132   1283 1303          M         banksel     0x75
0134   0875               M         movf        0x75,w
0135   2???               M         call        rtc_convert   
0136   0877           00461         MOVFW       0X77
0137   00C7           00462         MOVWF       start_min10
0138   0878           00463         MOVFW       0X78
0139   00C6           00464         MOVWF       start_min
                      00465 
                      00466         ;Get seconds
                      00467         rtc_read    0x00                ;Read Address 0x00 from DS1307---seconds
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
013A   3000               M         movlw       0x00
013B   1283 1303          M         banksel     0x73
013D   00F3               M         movwf       0x73
013E   2???               M         call        read_rtc
013F   1283 1303          M         banksel     0x75
0141   0875               M         movf        0x75,w
0142   2???               M         call        rtc_convert   
0143   0877           00468         MOVFW       0X77
0144   00C9           00469         MOVWF       start_sec10
0145   0878           00470         MOVFW       0X78
0146   00C8           00471         MOVWF       start_sec
0147   0008           00472         RETURN
                      00473 ;******************************************************************************;
                      00474 ;                           RETREIVE STOP TIME                                 ;
                      00475 ;******************************************************************************;
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0148                  00476 GET_STOP_TIME
                      00477         ;Get minute             
                      00478         rtc_read    0x01                ;Read Address 0x01 from DS1307---min
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
0148   3001               M         movlw       0x01
0149   1283 1303          M         banksel     0x73
014B   00F3               M         movwf       0x73
014C   2???               M         call        read_rtc
014D   1283 1303          M         banksel     0x75
014F   0875               M         movf        0x75,w
0150   2???               M         call        rtc_convert   
0151   0877           00479         MOVFW       0X77
0152   00CB           00480         MOVWF       stop_min10
0153   0878           00481         MOVFW       0X78
0154   00CA           00482         MOVWF       stop_min
                      00483 
                      00484         ;Get seconds
                      00485         rtc_read    0x00                ;Read Address 0x00 from DS1307---seconds
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
0155   3000               M         movlw       0x00
0156   1283 1303          M         banksel     0x73
0158   00F3               M         movwf       0x73
0159   2???               M         call        read_rtc
015A   1283 1303          M         banksel     0x75
015C   0875               M         movf        0x75,w
015D   2???               M         call        rtc_convert   
015E   0877           00486         MOVFW       0X77
015F   00CD           00487         MOVWF       stop_sec10
0160   0878           00488         MOVFW       0X78
0161   00CC           00489         MOVWF       stop_sec
0162   0008           00490         RETURN
                      00491 ;******************************************************************************;
                      00492 ;                       DISPLAY RTC TIME TO LCD                                ;
                      00493 ;******************************************************************************;
0163                  00494 SHOW_RTC
                      00495         ;clear LCD screen
0163   3001           00496         movlw       b'00000001'
0164   2???           00497         call        WR_INS
                      00498 
                      00499         ;Get year
                      00500         WRT_LCD     "2"
0165   3032               M         MOVLW       "2"
0166   2???               M         CALL        WR_DATA
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00501         WRT_LCD     "0"
0167   3030               M         MOVLW       "0"
0168   2???               M         CALL        WR_DATA
                      00502         rtc_read    0x06                ;Read Address 0x06 from DS1307---year
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
0169   3006               M         movlw       0x06
016A   1283 1303          M         banksel     0x73
016C   00F3               M         movwf       0x73
016D   2???               M         call        read_rtc
016E   1283 1303          M         banksel     0x75
0170   0875               M         movf        0x75,w
0171   2???               M         call        rtc_convert   
                      00503         WRT_MEM_LCD 0x77
0172   0877               M         MOVFW       0x77
0173   2???               M         CALL        WR_DATA
                      00504         WRT_MEM_LCD 0x78
0174   0878               M         MOVFW       0x78
0175   2???               M         CALL        WR_DATA
                      00505 
                      00506         WRT_LCD     "/"
0176   302F               M         MOVLW       "/"
0177   2???               M         CALL        WR_DATA
                      00507 
                      00508         ;Get month
                      00509         rtc_read    0x05                ;Read Address 0x05 from DS1307---month
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
0178   3005               M         movlw       0x05
0179   1283 1303          M         banksel     0x73
017B   00F3               M         movwf       0x73
017C   2???               M         call        read_rtc
017D   1283 1303          M         banksel     0x75
017F   0875               M         movf        0x75,w
0180   2???               M         call        rtc_convert   
                      00510         WRT_MEM_LCD 0x77
0181   0877               M         MOVFW       0x77
0182   2???               M         CALL        WR_DATA
                      00511         WRT_MEM_LCD 0x78
0183   0878               M         MOVFW       0x78
0184   2???               M         CALL        WR_DATA
                      00512 
                      00513         WRT_LCD     "/"
0185   302F               M         MOVLW       "/"
0186   2???               M         CALL        WR_DATA
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00514 
                      00515         ;Get day
                      00516         rtc_read    0x04                ;Read Address 0x04 from DS1307---day
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
0187   3004               M         movlw       0x04
0188   1283 1303          M         banksel     0x73
018A   00F3               M         movwf       0x73
018B   2???               M         call        read_rtc
018C   1283 1303          M         banksel     0x75
018E   0875               M         movf        0x75,w
018F   2???               M         call        rtc_convert   
                      00517         WRT_MEM_LCD 0x77
0190   0877               M         MOVFW       0x77
0191   2???               M         CALL        WR_DATA
                      00518         WRT_MEM_LCD 0x78
0192   0878               M         MOVFW       0x78
0193   2???               M         CALL        WR_DATA
                      00519 
0194   30C0           00520         movlw       B'11000000'         ;Next line displays (hour):(min):(sec) **:**:**
0195   2???           00521         call        WR_INS
                      00522         ;Get hour
                      00523         rtc_read    0x02                ;Read Address 0x02 from DS1307---hour
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
0196   3002               M         movlw       0x02
0197   1283 1303          M         banksel     0x73
0199   00F3               M         movwf       0x73
019A   2???               M         call        read_rtc
019B   1283 1303          M         banksel     0x75
019D   0875               M         movf        0x75,w
019E   2???               M         call        rtc_convert   
                      00524         WRT_MEM_LCD 0x77
019F   0877               M         MOVFW       0x77
01A0   2???               M         CALL        WR_DATA
                      00525         WRT_MEM_LCD 0x78
01A1   0878               M         MOVFW       0x78
01A2   2???               M         CALL        WR_DATA
                      00526         WRT_LCD     ":"
01A3   303A               M         MOVLW       ":"
01A4   2???               M         CALL        WR_DATA
                      00527 
                      00528         ;Get minute             
                      00529         rtc_read    0x01                ;Read Address 0x01 from DS1307---min
                          M ;input:         addliteral
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
01A5   3001               M         movlw       0x01
01A6   1283 1303          M         banksel     0x73
01A8   00F3               M         movwf       0x73
01A9   2???               M         call        read_rtc
01AA   1283 1303          M         banksel     0x75
01AC   0875               M         movf        0x75,w
01AD   2???               M         call        rtc_convert   
                      00530         WRT_MEM_LCD 0x77
01AE   0877               M         MOVFW       0x77
01AF   2???               M         CALL        WR_DATA
                      00531         WRT_MEM_LCD 0x78
01B0   0878               M         MOVFW       0x78
01B1   2???               M         CALL        WR_DATA
                      00532         WRT_LCD     ":"
01B2   303A               M         MOVLW       ":"
01B3   2???               M         CALL        WR_DATA
                      00533 
                      00534         ;Get seconds
                      00535         rtc_read    0x00                ;Read Address 0x00 from DS1307---seconds
                          M ;input:         addliteral
                          M ;output:        0x75, 0x77, 0x78
                          M ;desc:          From the selected register in the RTC, read the data
                          M ;                       and load it into 0x75. 0x75 is also converted into 
                          M ;                       ASCII characters and the tens digit is placed into
                          M ;                       0x77 and the ones digit is placed in 0x78
01B4   3000               M         movlw       0x00
01B5   1283 1303          M         banksel     0x73
01B7   00F3               M         movwf       0x73
01B8   2???               M         call        read_rtc
01B9   1283 1303          M         banksel     0x75
01BB   0875               M         movf        0x75,w
01BC   2???               M         call        rtc_convert   
                      00536         WRT_MEM_LCD 0x77
01BD   0877               M         MOVFW       0x77
01BE   2???               M         CALL        WR_DATA
                      00537         WRT_MEM_LCD 0x78
01BF   0878               M         MOVFW       0x78
01C0   2???               M         CALL        WR_DATA
                      00538 
01C1   0008           00539         RETURN
                      00540 ;******************************************************************************;
                      00541 ;                       INITIALIZE RTC TIME                                    ;
                      00542 ;******************************************************************************;                
01C2                  00543 SET_RTC_TIME
                      00544         rtc_resetAll    ;reset rtc
                          M ;input:         none
                          M ;output:        none
                          M ;desc:          Resets all the time keeping registers on the RTC to zero
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01C2   1283 1303          M         banksel     0x74
01C4   01F4               M         clrf        0x74
01C5   1283 1303          M         banksel     0x73
01C7   01F3               M         clrf        0x73
01C8   2???               M         call        write_rtc           ;Write 0 to Seconds
01C9   1283 1303          M         banksel     0x73
Message[305]: Using default destination of 1 (file).
01CB   0AF3               M         incf        0x73                        ;Set register address to 1
01CC   2???               M         call        write_rtc
01CD   1283 1303          M         banksel     0x73
Message[305]: Using default destination of 1 (file).
01CF   0AF3               M         incf        0x73                        ;Set register address to 2
01D0   2???               M         call        write_rtc
01D1   1283 1303          M         banksel     0x73
Message[305]: Using default destination of 1 (file).
01D3   0AF3               M         incf        0x73                        ;Set register address to 3
01D4   2???               M         call        write_rtc
01D5   1283 1303          M         banksel     0x73
Message[305]: Using default destination of 1 (file).
01D7   0AF3               M         incf        0x73                        ;Set register address to 4
01D8   2???               M         call        write_rtc
01D9   1283 1303          M         banksel     0x73
Message[305]: Using default destination of 1 (file).
01DB   0AF3               M         incf        0x73                        ;Set register address to 5
01DC   2???               M         call        write_rtc
01DD   1283 1303          M         banksel     0x73
Message[305]: Using default destination of 1 (file).
01DF   0AF3               M         incf        0x73                        ;Set register address to 6
01E0   2???               M         call        write_rtc
                      00545 
                      00546         rtc_set     0x00,       B'10000000'
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
01E1   1283 1303          M         banksel     0x73
01E3   3000               M         movlw       0x00
01E4   00F3               M         movwf       0x73
01E5   1283 1303          M         banksel     0x74
01E7   3080               M         movlw       B'10000000'
01E8   00F4               M         movwf       0x74        
01E9   2???               M         call        write_rtc
                      00547 
                      00548         ;set time 
                      00549         rtc_set     0x06,       B'00010110'             ; Year
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
01EA   1283 1303          M         banksel     0x73
01EC   3006               M         movlw       0x06
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

01ED   00F3               M         movwf       0x73
01EE   1283 1303          M         banksel     0x74
01F0   3016               M         movlw       B'00010110'
01F1   00F4               M         movwf       0x74        
01F2   2???               M         call        write_rtc
                      00550         rtc_set     0x05,       B'00000100'             ; Month
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
01F3   1283 1303          M         banksel     0x73
01F5   3005               M         movlw       0x05
01F6   00F3               M         movwf       0x73
01F7   1283 1303          M         banksel     0x74
01F9   3004               M         movlw       B'00000100'
01FA   00F4               M         movwf       0x74        
01FB   2???               M         call        write_rtc
                      00551         rtc_set     0x04,       B'00000110'             ; Date
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
01FC   1283 1303          M         banksel     0x73
01FE   3004               M         movlw       0x04
01FF   00F3               M         movwf       0x73
0200   1283 1303          M         banksel     0x74
0202   3006               M         movlw       B'00000110'
0203   00F4               M         movwf       0x74        
0204   2???               M         call        write_rtc
                      00552         rtc_set     0x03,       B'00000010'             ; Day
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
0205   1283 1303          M         banksel     0x73
0207   3003               M         movlw       0x03
0208   00F3               M         movwf       0x73
0209   1283 1303          M         banksel     0x74
020B   3002               M         movlw       B'00000010'
020C   00F4               M         movwf       0x74        
020D   2???               M         call        write_rtc
                      00553         rtc_set     0x02,       B'00000000'             ; Hours
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
020E   1283 1303          M         banksel     0x73
0210   3002               M         movlw       0x02
0211   00F3               M         movwf       0x73
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0212   1283 1303          M         banksel     0x74
0214   3000               M         movlw       B'00000000'
0215   00F4               M         movwf       0x74        
0216   2???               M         call        write_rtc
                      00554         rtc_set     0x01,       B'00000000'             ; Minutes
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
0217   1283 1303          M         banksel     0x73
0219   3001               M         movlw       0x01
021A   00F3               M         movwf       0x73
021B   1283 1303          M         banksel     0x74
021D   3000               M         movlw       B'00000000'
021E   00F4               M         movwf       0x74        
021F   2???               M         call        write_rtc
                      00555         rtc_set     0x00,       B'00000000'             ; Seconds
                          M ;input:         addliteral: value of address
                          M ;                       datliteral: value of data
                          M ;output:        none
                          M ;desc:          loads the data in datliteral into the 
                          M ;                       address specified by addliteral in the RTC
0220   1283 1303          M         banksel     0x73
0222   3000               M         movlw       0x00
0223   00F3               M         movwf       0x73
0224   1283 1303          M         banksel     0x74
0226   3000               M         movlw       B'00000000'
0227   00F4               M         movwf       0x74        
0228   2???               M         call        write_rtc
0229   0008           00556         return
                      00557 
                      00558 ;******************************************************************************;                
                      00559 ;******************************************************************************;
                      00560 ;******************************************************************************;
022A                  00561 DIV16X8 ; DIV_HI and DIV_LO / DIVSOR.  result to Q
                      00562                 ; does not deal with divide by 0 case
022A   01C5           00563         CLRF Q
022B                  00564 DIV_1
022B   0844           00565         MOVF DIVISOR, W
022C   02C3           00566         SUBWF DIV_LO, F
022D   1C03           00567         BTFSS STATUS, C ; if positive skip
022E   2???           00568         GOTO BORROW
022F   2???           00569         GOTO DIV_2
0230                  00570 BORROW
0230   3001           00571         MOVLW 0x01
0231   02C2           00572         SUBWF DIV_HI, F ; DIV_HI = DIV_HI - 1
0232   1C03           00573         BTFSS STATUS, C ; if no borrow occurred
0233   2???           00574         GOTO DIV_DONE   
0234                  00575 DIV_2
0234   0AC5           00576         INCF Q, F
0235   2???           00577         GOTO DIV_1
0236                  00578 DIV_DONE
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0236   0008           00579         RETURN
                      00580         
0237                  00581 LONG_DLY
0237   30FF           00582         MOVLW       0xFF
0238   00BF           00583         MOVWF       long_del
0239                  00584 LD_LOOP 
                      00585         LCD_DLY
0239   30FF               M         MOVLW       0xFF
023A   00BD               M         MOVWF       lcd_d1
023B   0BBD               M         DECFSZ      lcd_d1, f
023C   2???               M         GOTO        $-1
023D   0BBF           00586         DECFSZ      long_del, f
023E   2???           00587         GOTO        LD_LOOP
023F   0008           00588         RETURN
                      00589         
                      00590     ;Delay: ~5ms
0240                  00591 LCD_LONG_DELAY
0240   3014           00592         MOVLW       d'20'
0241   00BE           00593         MOVWF       lcd_d2
0242                  00594 LLD_LOOP
                      00595         LCD_DLY
0242   30FF               M         MOVLW       0xFF
0243   00BD               M         MOVWF       lcd_d1
0244   0BBD               M         DECFSZ      lcd_d1, f
0245   2???               M         GOTO        $-1
0246   0BBE           00596         DECFSZ      lcd_d2, f
0247   2???           00597         GOTO        LLD_LOOP
0248   0008           00598         RETURN
0249                  00599 FINISH  
0249   2???           00600         GOTO    FINISH
                      00601         
3F72                  00602         END
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 23


SYMBOL TABLE
  LABEL                             VALUE 

ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ADCON0                            0000001F
ADCON1                            0000009F
ADCS0                             00000006
ADCS1                             00000007
ADD                               00000036
ADDEN                             00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADON                              00000000
ADRESH                            0000001E
ADRESL                            0000009E
ARM_TOGGLE                        0000007F
B1                                0000003A
B2                                0000003B
BCLIE                             00000003
BCLIF                             00000003
BF                                00000000
BORROW                            00000230
BRGH                              00000002
C                                 00000000
CALIBRATE                         00000054
CCP1CON                           00000017
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000001D
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2X                             00000005
CCP2Y                             00000004
CCPR1                             00000015
CCPR1H                            00000016
CCPR1L                            00000015
CCPR2                             0000001B
CCPR2H                            0000001C
CCPR2L                            0000001B
CHS0                              00000003
CHS1                              00000004
CHS2                              00000005
CKE                               00000006
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 24


SYMBOL TABLE
  LABEL                             VALUE 

CKP                               00000004
CLR_LCD                           00000000
CONTROL                           00000035
CREN                              00000004
CSRC                              00000007
D                                 00000005
DAT                               00000037
DATA_ADDRESS                      00000005
DATA_LOOP                         000000B8
DC                                00000001
DIV16X8                           0000022A
DIVISOR                           00000044
DIV_1                             0000022B
DIV_2                             00000234
DIV_DONE                          00000236
DIV_HI                            00000042
DIV_LO                            00000043
DOUT                              00000039
D_A                               00000005
D_NOT_A                           00000005
EEADR                             0000010D
EEADRH                            0000010F
EECON1                            0000018C
EECON2                            0000018D
EEDATA                            0000010C
EEDATH                            0000010E
EEIE                              00000004
EEIF                              00000004
EEPGD                             00000007
F                                 00000001
FERR                              00000002
FINISH                            00000249
FSR                               00000004
GCEN                              00000007
GET_START_TIME                    0000012D
GET_STOP_TIME                     00000148
GIE                               00000007
GO                                00000002
GO_DONE                           00000002
GO_NOT_DONE                       00000002
I2C_DATA                          00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IBF                               00000007
IBOV                              00000005
INDF                              00000000
INIT                              00000005
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
INT_HANDLER                       0000005B
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 25


SYMBOL TABLE
  LABEL                             VALUE 

IRP                               00000007
InitLCD                           00000000
LCD_DLY                           
LCD_INS                           
LCD_LONG_DELAY                    00000240
LD_LOOP                           00000239
LLD_LOOP                          00000242
LONG_DLY                          00000237
MULT                              
MX_LOOP                           00000072
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BO                            00000000
NOT_BOR                           00000000
NOT_DONE                          00000002
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RC8                           00000006
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_TX8                           00000006
NOT_W                             00000002
NOT_WRITE                         00000002
OBF                               00000006
OERR                              00000001
OPTION_REG                        00000081
P                                 00000004
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000002
PCLATH                            0000000A
PCON                              0000008E
PEIE                              00000006
PEN                               00000002
PIE1                              0000008C
PIE2                              0000008D
PIR1                              0000000C
PIR2                              0000000D
PORTA                             00000005
PORTB                             00000006
PORTC                             00000007
PORTD                             00000008
PORTE                             00000009
PR2                               00000092
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
PSPIE                             00000007
PSPIF                             00000007
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 26


SYMBOL TABLE
  LABEL                             VALUE 

PSPMODE                           00000004
PWML                              00000066
PWML_DN                           00000068
PWMR                              0000006B
PWMR_DN                           0000006D
Q                                 00000045
R                                 00000002
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC3                               00000003
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RC8_9                             00000006
RC9                               00000006
RCD8                              00000000
RCEN                              00000003
RCIE                              00000005
RCIF                              00000005
RCREG                             0000001A
RCSTA                             00000018
RD                                00000000
RD0                               00000000
RD1                               00000001
RD2                               00000002
RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
READ_IRS                          00000070
READ_WRITE                        00000002
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 27


SYMBOL TABLE
  LABEL                             VALUE 

REALIGN                           00000080
RETURN_HOME                       000000A5
RP0                               00000005
RP1                               00000006
RSEN                              00000001
RX9                               00000006
RX9D                              00000000
R_NOT_W                           00000002
R_W                               00000002
S                                 00000003
SCAN                              00000055
SEN                               00000000
SET_RTC_TIME                      000001C2
SHOW_RTC                          00000163
SMP                               00000007
SPBRG                             00000099
SPEN                              00000007
SREN                              00000005
SSPADD                            00000093
SSPBUF                            00000013
SSPCON                            00000014
SSPCON2                           00000091
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000094
START_MSG                         000000DC
START_STDBY                       0000004A
STATUS                            00000003
STOP_DATA                         000000AD
STOP_STDBY                        000000A6
STOP_STDBY_MSG                    000000F9
SYNC                              00000004
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000010
T1INSYNC                          00000002
T1OSCEN                           00000003
T1SYNC                            00000002
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000012
TMR0                              00000001
TMR0IE                            00000005
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 28


SYMBOL TABLE
  LABEL                             VALUE 

TMR0IF                            00000002
TMR1                              0000000E
TMR1CS                            00000001
TMR1H                             0000000F
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             0000000E
TMR1ON                            00000000
TMR2                              00000011
TMR2IE                            00000001
TMR2IF                            00000001
TMR2ON                            00000002
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000085
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISB                             00000086
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000087
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000088
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000089
TRISE0                            00000000
TRISE1                            00000001
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 29


SYMBOL TABLE
  LABEL                             VALUE 

TRISE2                            00000002
TRMT                              00000001
TX8_9                             00000006
TX9                               00000006
TX9D                              00000000
TXD8                              00000000
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXREG                             00000019
TXSTA                             00000098
UA                                00000001
USHOLD                            0000008F
USONIC_READ_ECHO                  0000008C
USONIC_SEND_PULSE                 00000081
W                                 00000000
WCOL                              00000007
WR                                00000001
WREN                              00000002
WRERR                             00000003
WRT_DATA                          00000116
WRT_LCD                           
WRT_MEM_LCD                       
WR_DATA                           00000000
WR_INS                            00000000
XBUF                              00000033
Z                                 00000002
_.org_1_0050                      00000050
_.org_1_0085                      00000085
_.org_1_008A                      0000008A
_.org_1_008D                      0000008D
_.org_1_023C                      0000023C
_.org_1_0245                      00000245
_BODEN_OFF                        00003FBF
_BODEN_ON                         00003FFF
_BOREN_OFF                        00003FBF
_BOREN_ON                         00003FFF
_CONFIG                           00002007
_CPD_OFF                          00003FFF
_CPD_ON                           00003EFF
_CP_ALL                           00000FCF
_CP_HALF                          00001FDF
_CP_OFF                           00003FFF
_CP_UPPER_256                     00002FEF
_DEBUG_OFF                        00003FFF
_DEBUG_ON                         000037FF
_DEVID1                           00002006
_FOSC_EXTRC                       00003FFF
_FOSC_HS                          00003FFE
_FOSC_LP                          00003FFC
_FOSC_XT                          00003FFD
_HS_OSC                           00003FFE
_IDLOC0                           00002000
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 30


SYMBOL TABLE
  LABEL                             VALUE 

_IDLOC1                           00002001
_IDLOC2                           00002002
_IDLOC3                           00002003
_LP_OSC                           00003FFC
_LVP_OFF                          00003F7F
_LVP_ON                           00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FF7
_RC_OSC                           00003FFF
_WDTE_OFF                         00003FFB
_WDTE_ON                          00003FFF
_WDT_OFF                          00003FFB
_WDT_ON                           00003FFF
_WRT_ENABLE_OFF                   00003DFF
_WRT_ENABLE_ON                    00003FFF
_WRT_OFF                          00003DFF
_WRT_ON                           00003FFF
_XT_OSC                           00003FFD
__16F877                          00000001
__DEBUG                           
__MPLAB_DEBUGGER_PICKIT2          1
count                             00000034
crit_dist                         d'5'
dt1                               00000030
dt2                               00000031
dt3                               00000032
flag                              00000038
i2c_common_setup                  00000000
lcd_d1                            0000003D
lcd_d2                            0000003E
lcd_tmp                           0000003C
long_del                          0000003F
measured_distance                 00000050
multiplex_count                   0000004E
num_spots                         00000053
read_rtc                          00000000
rob_distance                      0000004F
rob_return                        00000051
rtc_convert                       00000000
rtc_read                          
rtc_resetAll                      
rtc_set                           
spot_base_loc                     00000054
spot_count                        00000052
start_min                         00000046
start_min10                       00000047
start_sec                         00000048
start_sec10                       00000049
stop_min                          0000004A
stop_min10                        0000004B
stop_sec                          0000004C
stop_sec10                        0000004D
temp_status                       00000041
MPASM 5.65                          MAIN.ASM   2-28-2016  14:06:06         PAGE 31


SYMBOL TABLE
  LABEL                             VALUE 

temp_w                            00000040
write_rtc                         00000000

Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :    23 reported,     0 suppressed

